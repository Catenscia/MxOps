allowed_networks:
  - localnet
  - testnet
  - devnet

allowed_scenario:
  - "integration_test_wrapping"

steps:
  
  - type: ContractQuery
    contract: egld_wrapper_shard_2
    endpoint: getWrappedEgldTokenId
    arguments: []
    expected_results:
      - save_key: WrappedTokenIdentifier
        result_type: str

  - type: ContractCall
    sender: user
    contract: egld_wrapper_shard_2
    endpoint: wrapEgld
    value: 10000
    gas_limit: 3000000
    checks:
      - type: Success

      - type: Transfers
        condition: exact
        include_gas_refund: false  # optional, false by default
        expected_transfers:
          - sender: "[user]"
            receiver: "%egld_wrapper_shard_2%address"
            token_identifier: EGLD
            amount: 10000
          - sender: "%egld_wrapper_shard_2%address"
            receiver: "[user]"
            token_identifier: "%egld_wrapper_shard_2%WrappedTokenIdentifier"
            amount: 10000

  - type: ContractCall
    sender: user
    contract: egld_wrapper_shard_2
    endpoint: unwrapEgld
    gas_limit: 3000000
    esdt_transfers:
      - token_identifier: "%egld_wrapper_shard_2%WrappedTokenIdentifier"
        amount: 10000
        nonce: 0
    checks:
      - type: Success

      - type: Transfers
        condition: exact
        include_gas_refund: false  # optional, false by default
        expected_transfers:
          - sender: "[user]"
            receiver: "%egld_wrapper_shard_2%address"
            token_identifier: "%egld_wrapper_shard_2%WrappedTokenIdentifier"
            amount: 10000
          - sender: "%egld_wrapper_shard_2%address"
            receiver: "[user]"
            token_identifier: EGLD
            amount: 10000