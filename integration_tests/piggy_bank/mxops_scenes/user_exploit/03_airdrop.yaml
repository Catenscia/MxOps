allowed_networks:
  - localnet
  - testnet
  - devnet
  - chain-simulator

allowed_scenario:
  - "integration_test_piggy_bank_user_exploit"

steps:
  - type: ContractCall
    sender: jean
    contract: "abc-esdt-minter"
    endpoint: addAirdropAmount
    gas_limit: 5000000
    arguments:
      - "%thomas.address"
      - 100000

  - type: ContractCall
    sender: thomas
    contract: "abc-esdt-minter"
    endpoint: claimAirdrop
    gas_limit: 5000000
    checks:
      - type: Success

      - type: Transfers
        condition: exact
        include_gas_refund: false  # optional, false by default
        expected_transfers:
          - sender: "%abc-esdt-minter.address"
            receiver: "%thomas.address"
            token_identifier: "%abc-esdt-minter.EsdtIdentifier"
            amount: 100000
    results_save_keys: 
      - thomas_airdrop_amount

  - type: Python
    module_path: ./integration_tests/scripts/checks.py
    function: check_storage
    arguments:
      - abc-esdt-minter
      - '{"thomas_airdrop_amount": 100000}'